#!/bin/zsh

CURRENT_TIMESTAMP_PREEXEC=$SECONDS
function ganglio_preexec {
	CURRENT_TIMESTAMP_PREEXEC=$SECONDS
}

function ganglio_precmd {
	local stl
	let ELAPSED=$SECONDS-$CURRENT_TIMESTAMP_PREEXEC
	if [[ "$ELAPSED" -gt "0" ]]; then
		elapsed=">>> $ELAPSED"
		len=${#${elapsed}}
		now=$(date +%H:%M:%S)
		nowlen=${#${now}}
		print -P -- "$FX[bold]$FG[087]$elapsed $FG[239]${(l:($COLUMNS-$len-$nowlen-2)::-:)} $FG[226]$now$reset_color"
	fi
}

# Load required functions.
autoload -Uz add-zsh-hook

# Add hook for calling git-info before each command.
add-zsh-hook preexec ganglio_preexec
add-zsh-hook precmd ganglio_precmd
